# <a name="Headlines Plugin"></a><a name=" Headlines Plugin"></a> Headlines Plugin

<div>
  <ul>
    <li><a href="#Description"> Description</a></li>
    <li><a href="#Syntax Rules"> Syntax Rules</a><ul>
        <li><a href="#Rendering the <code>dc</code> namespace"> Rendering the dc namespace</a></li>
        <li><a href="#Rendering the <code>image</code> namespace"> Rendering the image namespace</a></li>
        <li><a href="#Rendering the <code>content</code> namespac"> Rendering the content namespace</a></li>
      </ul>
    </li>
    <li><a href="#Examples"> Examples</a><ul>
        <li><a href="#Slashdot News"> Slashdot News</a></li>
        <li><a href="#Business Opportunities Weblog"> Business Opportunities Weblog</a></li>
      </ul>
    </li>
    <li><a href="#Plugin Settings"> Plugin Settings</a></li>
    <li><a href="#Style sheets"> Style sheets</a></li>
    <li><a href="#Plugin Installation Instructions"> Plugin Installation Instructions</a></li>
    <li><a href="#Plugin Info"> Plugin Info</a></li>
  </ul>
</div>

## <a name="Description"></a> Description

This plugin displays RSS and ATOM feeds from news sites. Use it to build news portals that show headline news.

**_Note:_** Syndic8.com ( <http://www.syndic8.com/> ) is a good site listing many RSS feeds.

## <a name="Syntax Rules"></a> Syntax Rules

`%HEADLINES{"..."}%`

<table border="1" cellpadding="0" cellspacing="0">
  <tr>
    <th bgcolor="#99CCCC"><strong> Parameter </strong></th>
    <th bgcolor="#99CCCC"><strong> Explanation </strong></th>
    <th bgcolor="#99CCCC"><strong> Default </strong></th>
  </tr>
  <tr>
    <td><code>"..."</code></td>
    <td> source of RSS feed; this can be an url (starting with http) or a web.topic location for internal feeds </td>
    <td> None; is required </td>
  </tr>
  <tr>
    <td><code>href="..."</code></td>
    <td> (Alternative to above) </td>
    <td> N/A </td>
  </tr>
  <tr>
    <td><code>refresh="60"</code></td>
    <td> Refresh rate in minutes for caching feed; <code>"0"</code> for no caching </td>
    <td> Global <code>REFRESH</code> setting </td>
  </tr>
  <tr>
    <td><code>limit="12"</code></td>
    <td> Maximum number of items shown </td>
    <td> Global <code>LIMIT</code> setting </td>
  </tr>
  <tr>
    <td><code>header</code></td>
    <td> Header. Can include these variables: - $channeltitle, $title: title of channel (channel.title) %BR% - $channellink, $link: link of channel (channel.link) %BR% - $channeldescription, $description: description (channel.description) %BR% - $channeldate, $date: publication date of the channel (channel.pubDate) %BR% - $rights: copyrights of the channel (channel.copyright) %BR% - $imagetitle: title text for site (image.title) %BR% - $imagelink: link for site (image.link) %BR% - $imageurl: URL of image (image.url) %BR% - $imagedescription: description of image (image.description) </td>
    <td> Global <code>HEADER</code> setting </td>
  </tr>
  <tr>
    <td><code>format</code></td>
    <td> Format of one item. Can include these variables: %BR% - $title: news item title (item.title) %BR% - $link: news item link (item.link) %BR% - $description: news item description (item.description) %BR% - $date: the publication date (item.pubDate, item.date) %BR% - $category: the article category (item.category) </td>
    <td> Global <code>FORMAT</code> setting </td>
  </tr>
</table>

The `header` and `format` parameters might also use variables rendering the `dc`, `image` and `content` namespace information. Note, that only bits of interest have been implemented so far and those namespaces might not be implemented fully yet.

### <a name="Rendering the &lt;code&gt;dc&lt;/code&gt; namespace"></a> Rendering the `dc` namespace

The following variables are extracting the `dc` namespace info, that could be used in `header` and `format`. Nnote, that some of the variables are already used above. This is done by purpose to use different feeds with the same formating parameters. If there's a conflict the non-dc tags have higher precedence, i.e. a &lt;title&gt; content &lt;/title&gt; is prefered over &lt;dc:title&gt; content &lt;/dc:title&gt; .

- $title: channel/article title (dc:title)
- $creator: channel creator (dc:creator)
- $subject: subject text; this will also add an image according to the subject hash list, see [[above|Main/WebHome#Subject_Images]] (dc:subject)
- $description: ... (dc:description)
- $publisher: the channel/article publisher (dc:publisher)
- $contributor: ... (dc:contributor)
- $date: ... (dc:date)
- $type: ... (dc:type)
- $format: ... (dc:format)
- $identifier: ... (dc:identifier)
- $source: ... (dc:source)
- $language: ... (dc:language)
- $relation: ... (dc:relation)
- $coverage: ... (dc: coverage)
- $rights: ... (dc: rights)

### <a name="Rendering the &lt;code&gt;image&lt;/code&gt; namespace"></a> Rendering the `image` namespace

An `image:item` is converted into an &lt;img&gt; tag using the following mappings:

- `src`: image url (rdf:about attribute of the image.item tag)
- `alt`: image title (title)
- `width`: image width (image:width)
- `height`: image height image:height)

### <a name="Rendering the &lt;code&gt;content&lt;/code&gt; namespac"></a> Rendering the `content` namespace

The variable $content is refering to the &lt;content:encoding&gt; content &lt;/content:encoding&gt;.

## <a name="Examples"></a> Examples

### <a name="Slashdot News"></a> Slashdot News

Write

    %HEADLINES{"http://slashdot.org/slashdot.rdf"
      header="*[[$link][$title]]:* $description"
      format="$t* [[$link][$title]]"
    }%

to get the latest Slashdot news as a bullet list format:

%HEADLINES\{"http://slashdot.org/slashdot.rdf" header="---+!! [[$title|Main/Link]]$n $description" format="$t\* [[$title|Main/Link]]"\}%

### <a name="Business Opportunities Weblog"></a> Business Opportunities Weblog

Write

    %HEADLINES{"http://www.business-opportunities.biz/feed" limit="3"}%

to get the latest postings on the "Business Opportunities" weblog:

%HEADLINES\{"http://www.business-opportunities.biz/feed" limit="3"\}%

## <a name="Plugin Settings"></a> Plugin Settings

Plugin settings are stored as preferences variables. To reference a plugin setting write <code>**%&lt;plugin&gt;\_&lt;setting&gt;%**</code>, for example, <code>**%HEADLINESPLUGIN\_SHORTDESCRIPTION%**</code>. **Note:** Don't modify the settings here; copy and customize the settings in [[Main.TWikiPreferences|Main/TWikiPreferences]]. For example, to customize the USERAGENTNAME setting, create a HEADLINESPLUGIN\_USERAGENTNAME setting in Main.TWikiPreferences.

- One line description, shown in the [[TextFormattingRules]] topic:
  - Set SHORTDESCRIPTION = Show headline news in TWiki pages based on RSS and ATOM news feeds from external sites

- Refresh rate in minutes for cached feeds. Disable caching: `0`, default: `60`
  - Set REFRESH = 60

- Maximum number of items shown. Default: `100`
  - Set LIMIT = 100

- Use LWP::UserAgent, or fallback to TWiki's internal `getUrl()` method. Default: `yes`
  - Set USELWPUSERAGENT = yes

- Timeout fetching a feed using the LWP::UserAgent. Default: `20`
  - Set USERAGENTTIMEOUT = 20

- Name of user agent. Default: `TWikiHeadlinesPlugin/2.21`

          * Set USERAGENTNAME = TWikiHeadlinesPlugin/2.21

- Default header: (variables are explained in the syntax rules)

          * Set HEADER = <div class="headlinesChannel"><div class="headlinesLogo"><img src="$imageurl" alt="$imagetitle" border="0" />%BR%</div><div class="headlinesTitle">$n---+!! <a href="$link">$title</a></div><div class="headlinesDate">$date</div><div class="headlinesDescription">$description</div><div class="headlinesRight">$rights</div></div>

- Default format of one item: (variables are explained in the syntax rules)

          * Set FORMAT = <div class="headlinesArticle"><div class="headlinesTitle"><a href="$link">$title</a></div>$n<span class="headlinesDate">$date</span> <span class="headlinesCreator"> $creator</span> <span class="headlinesSubject"> $subject </span>$n<div class="headlinesText"> $description</div></div>

- Values taken from configure: (only supported if CPAN:LWP is installed)
  - `$TWiki::cfg{PROXY}{HOST}` - proxy host, such as `"proxy.example.com";`
  - `$TWiki::cfg{PROXY}{PORT}` - proxy port, such as `"8080";`
  - `$TWiki::cfg{PROXY}{SkipProxyForDomains}` - domains excluded from proxy, such as `"intra.example.com, bugs.example.com";`

## <a name="Style sheets"></a> Style sheets

The default HEADER and FORMAT settings use the following styles. See the [style.css](http://www.dementia.org/twiki//view/style.css) file defining the default CSS properties (indentation illustrates enclosure).

- headlinesRss: output of the [[HeadlinesPlugin]] (div)
  - headlinesChannel: channel header (div)
    - headlinesLogo: channel logo (div)
    - headlinesTitle: channel title (div)
    - headlinesDate: channel date (div)
    - headlinesDescription: channel description (div)
    - headlinesRight: channel copyright (div)
  - headlinesArticle: one news item (div)
    - headlinesTitle: article title (div)
    - headlinesDate: article date (span)
    - headlinesCreator: author of article (span)
    - headlinesSubject: subect category of the article (span)
    - headlinesText: article text (div)

## <a name="Plugin Installation Instructions"></a> Plugin Installation Instructions

- [Download](http://www.dementia.org/twiki//view/%TOPIC%.zip) the ZIP file
- Unzip it in your twiki installation directory. Content: <table border="1" cellpadding="0" cellspacing="0">
  <tr>
    <th bgcolor="#99CCCC"><strong> File: </strong></th>
    <th bgcolor="#99CCCC"><strong> Description: </strong></th>
  </tr>
  <tr>
    <td><code><b>data/TWiki/%TOPIC%.txt</b></code></td>
    <td> plugin topic </td>
  </tr>
  <tr>
    <td><code><b>pub/TWiki/%TOPIC%/style.css</b></code></td>
    <td> default css </td>
  </tr>
  <tr>
    <td><code><b>lib/TWiki/%TOPIC%.pm</b></code></td>
    <td> plugin perl module </td>
  </tr>
  <tr>
    <td><code><b>lib/TWiki/%TOPIC%/Core.pm</b></code></td>
    <td> plugin core </td>
  </tr>
</table>
 Check if above examples show a news feed instead of variable.
- Optionally, run <code>**%TOPIC%\_installer.pl**</code> to automatically check and install other TWiki modules that this module depends on. You can also do this step manually.
- Alternatively, manually make sure the dependencies listed in the table below are resolved. <table border="1">
  <tr>
    <th>Name</th>
    <th>Version</th>
    <th>Description</th>
  </tr>
  <tr>
    <td align="left">Digest::MD5</td>
    <td align="left">&gt;=2.33</td>
    <td align="left">Required. Download from CPAN:Digest::MD5</td>
  </tr>
  <tr>
    <td align="left">LWP::UserAgent</td>
    <td align="left">&gt;=5.803</td>
    <td align="left">Optional. Download from CPAN:LWP::UserAgent</td>
  </tr>
</table>

## <a name="Plugin Info"></a> Plugin Info

<table border="1" cellpadding="0" cellspacing="0">
  <tr>
    <td align="right"> Plugin Author: </td>
    <td> TWiki:Main.PeterThoeny, TWiki:Main.MichaelDaum </td>
  </tr>
  <tr>
    <td align="right"> Copyright: </td>
    <td> © 2002-2009, Peter Thoeny, <a href="http://www.twiki.net/" target="_top">TWIKI.NET</a>; 2005-2007, Michael Daum <a href="http://wikiring.de" target="_top">http://wikiring.de</a></td>
  </tr>
  <tr>
    <td align="right"> License: </td>
    <td> GPL (<a href="http://www.gnu.org/copyleft/gpl.html" target="_top">GNU General Public License</a>) </td>
  </tr>
  <tr>
    <td align="right"> Plugin Version: </td>
    <td> v2.21 - 12 Feb 2009 </td>
  </tr>
  <tr>
    <td align="right"> Change History: </td>
    <td>  </td>
  </tr>
  <tr>
    <td align="right"> 12 Feb 2009: </td>
    <td> {PROXY}{HOST} supports domain with and without protocol -- Peter Thoeny </td>
  </tr>
  <tr>
    <td align="right"> 06 Feb 2009: </td>
    <td> added {PROXY}{SkipProxyForDomains} configure setting, added USERAGENTNAME plugin setting -- Peter Thoeny </td>
  </tr>
  <tr>
    <td align="right"> 11 Dec 2008: </td>
    <td> added {PROXY}{HOST} and {PROXY}{PORT} configure settings -- Peter Thoeny </td>
  </tr>
  <tr>
    <td align="right"> 13 Sep 2007: </td>
    <td> fixed parsing of content:encoded </td>
  </tr>
  <tr>
    <td align="right"> 23 Jul 2006: </td>
    <td> improved atom parser; if a posting has no title default to 'Untitled' </td>
  </tr>
  <tr>
    <td align="right"> 26 Apr 2006: </td>
    <td> added lazy compilation </td>
  </tr>
  <tr>
    <td align="right"> 10 Feb 2006: </td>
    <td> packaged using the TWiki:Plugins/BuildContrib; minor fixes </td>
  </tr>
  <tr>
    <td align="right"> 03 Feb 2006: </td>
    <td> off-by-one: limit="n" returned n+1 articles; make FORMAT and HEADER format strings more robust </td>
  </tr>
  <tr>
    <td align="right"> 23 Jan 2006: </td>
    <td> released v2.00 </td>
  </tr>
  <tr>
    <td align="right"> 05 Dec 2005: </td>
    <td> internal feed urls must be absolute </td>
  </tr>
  <tr>
    <td align="right"> 02 Dec 2005: </td>
    <td> added web.topic shorthand for internal feeds </td>
  </tr>
  <tr>
    <td align="right"> 29 Nov 2005: </td>
    <td> fixed CDATA handling </td>
  </tr>
  <tr>
    <td align="right"> 21 Nov 2005: </td>
    <td> added ATOM support; extended RSS support; added dublin core support; added content support; optionally using LWP to fetch feeds to follow redirections; corrected CPAN dependencies ; recoding special chars from html integer to entity encoding to increase browser compatibility; added css support; use <code>getWorkArea()</code> if available </td>
  </tr>
  <tr>
    <td align="right"> 11 May 2005: </td>
    <td> TWiki:Main.WillNorris: added DevelopBranch compatability </td>
  </tr>
  <tr>
    <td align="right"> 31 Oct 2004: </td>
    <td> Fixed taint issue by TWiki:Main.AdrianWeiler; small performance improvement </td>
  </tr>
  <tr>
    <td align="right"> 29 Oct 2004: </td>
    <td> Fixed issue of external caching if mod_perl or SpeedyCGI is used </td>
  </tr>
  <tr>
    <td align="right"> 02 Aug 2002: </td>
    <td> Implemented caching of feeds, thanks to TWiki:Main/RobDuarte </td>
  </tr>
  <tr>
    <td align="right"> 11 Jun 2002: </td>
    <td> Initial version (V1.000) </td>
  </tr>
  <tr>
    <td align="right"> Perl Version: </td>
    <td> 5.8 </td>
  </tr>
  <tr>
    <td align="right"> TWiki:Plugins/Benchmark: </td>
    <td>[[TWiki/GoodStyle]] 100%, [[TWiki/FormattedSearch]] 99.5%, %TOPIC% 94% </td>
  </tr>
  <tr>
    <td align="right"> Plugin Home: </td>
    <td> TWiki:Plugins/%TOPIC% </td>
  </tr>
  <tr>
    <td align="right"> Feedback: </td>
    <td> TWiki:Plugins/%TOPIC%Dev </td>
  </tr>
  <tr>
    <td align="right"> Appraisal: </td>
    <td> TWiki:Plugins/%TOPIC%Appraisal </td>
  </tr>
</table>

-- TWiki:Main.PeterThoeny - 12 Jan 2009 %BR% -- TWiki:Main.MichaelDaum - 13 Sep 2007
