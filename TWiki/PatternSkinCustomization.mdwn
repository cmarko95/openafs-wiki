# <a name="TWiki._PatternSkin Customization"></a><a name=" TWiki._PatternSkin Customizatio"></a> [[PatternSkin]] Customization

**Guidelines how to create and customize page templates.** For styling your TWiki using stylesheets, see [[PatternSkinCssCookbook]].

<div>
  <ul>
    <li><a href="#First Read: How to modify _Patt"> First Read: How to modify PatternSkin templates</a><ul>
        <li><a href="#The template approach"> The template approach</a></li>
        <li><a href="#The topic template approach (usi"> The topic template approach (using VIEW_TEMPLATE)</a></li>
      </ul>
    </li>
    <li><a href="#Reference: pattern skin template"> Reference: pattern skin template INCLUDE tree</a></li>
    <li><a href="#Logo"> Logo</a><ul>
        <li><a href="#How can I change the web logo?"> How can I change the web logo?</a></li>
        <li><a href="#How do I set a site-wide logo?"> How do I set a site-wide logo?</a></li>
        <li><a href="#My logo does not fit the top bar"> My logo does not fit the top bar</a></li>
        <li><a href="#I want to change the white space"> I want to change the white space above and below the logo</a></li>
      </ul>
    </li>
    <li><a href="#Top bar"> Top bar</a><ul>
        <li><a href="#The search box won't find topics"> The search box won't find topics in other webs</a></li>
        <li><a href="#I want to change the height of t"> I want to change the height of the top bar</a></li>
        <li><a href="#I want to set or change the top"> I want to set or change the top background image</a></li>
        <li><a href="#I want to have the web color in"> I want to have the web color in the top bar</a></li>
        <li><a href="#I want to remove the Jump and Se"> I want to remove the Jump and Search boxes from the top bar </a></li>
        <li><a href="#I want to hide the top bar"> I want to hide the top bar</a></li>
      </ul>
    </li>
    <li><a href="#Left bar"> Left bar</a><ul>
        <li><a href="#I want to hide the left bar"> I want to hide the left bar</a></li>
        <li><a href="#I want to make the left bar wide"> I want to make the left bar wider</a></li>
      </ul>
    </li>
    <li><a href="#Buttons"> Buttons</a><ul>
        <li><a href="#I want to hide the edit buttons"> I want to hide the edit buttons from certain users</a></li>
        <li><a href="#I want to remove the History but"> I want to remove the History button from the bottom</a></li>
        <li><a href="#I want to put the bottom links a"> I want to put the bottom links as buttons at the top</a></li>
      </ul>
    </li>
    <li><a href="#Other page parts"> Other page parts</a><ul>
        <li><a href="#I want to insert text outside of"> I want to insert text outside of the topic content</a></li>
        <li><a href="#I want to place the form at the"> I want to place the form at the top</a></li>
        <li><a href="#I want to put the topic form in"> I want to put the topic form in a twisty</a></li>
      </ul>
    </li>
  </ul>
</div>

## <a name="First Read: How to modify _Patte"></a> First Read: How to modify PatternSkin templates

Everything you see on the common 'view' page is written by the `view` template. For pattern skin this file is `/templates/view.pattern.tmpl`.

We describe two approaches to override this template:

1. By creating a custom skin file in the `templates` directory
2. By creating a custom topic template

Which approach is best?

- If you want to change the appearance for a lot of pages or even site-wide, the template approach is the easiest.
- If you want to change the appearance of a single topic, or a set of topics, use a topic template.

### <a name="The template approach"></a> The template approach

To change templates you will need shell access. If you don't have this read on below in [[The topic template approach|Main/WebHome#TopicTemplates]].

The quickest way to change the view template would be to simply change the text in the template. A safer way - strongly recommended, because it will survive a TWiki update - is to create your own custom skin. That may sound like an awful lot of work, but in reality a skin may be as much as 1 file that consists of only a few lines of code.

**Example** %BR% Let's say you want to simplify the bottom toolbar and remove all links except for "More topic actions". You would need to target `%TMPL:DEF{"topicactionbuttons"}%`, which is located in `view.pattern.tmpl`.

**The steps you would need:**

1. Think up a name for your skin. Let us use `myskin` for now.
2. Create a new (empty) view template file in `/templates` called `view.myskin.tmpl`.
3. In `view.myskin.tmpl` you write:
> %TMPL:INCLUDE{"view"}%
>        %TMPL:DEF{"top:toolbarbuttons"}%%TMPL:P{"more_link"}%%TMPL:END%
4. For testing, view any topic and append to the topic name: `?cover=myskin`. You should see an effect now.
5. To make the changes visible on all pages, go to [[Main.TWikiPreferences|Main/TWikiPreferences]] (to keep [[TWikiPreferences]] intact) and write:

> * Set COVER = myskin
>
> or write
>
>        * Set SKIN = myskin,pattern

Test by appending `?cover=myskin` to the url.

<a name="TopicTemplates"></a>

### <a name="The topic template approach (usi"></a> The topic template approach (using VIEW\_TEMPLATE)

Template overrides can be written in a topic, a so-called _topic template_. Topic template names end with `Template`, for instance `BlogPostViewTemplate`.

Call this template by setting `VIEW_TEMPLATE`:

> * Set VIEW_TEMPLATE = BlogPostView

- Note that you don't use the `Template` extension now
- You can make this setting hidden by writing this in the Settings screen: go to More and then Topic Settings
- On topic creation you can set the topic template by passing `templatetopic`:
       <input type="hidden" name="templatetopic" value="BlogPostViewTemplate" />

We can use the same example as above. In a topic write:

> %TMPL:INCLUDE{"view"}%
>     %TMPL:DEF{"top:toolbarbuttons"}%%TMPL:P{"more_link"}%%TMPL:END%

You can also test this by appending `?template=PersonalInfoView` to the url.

## <a name="Reference: pattern skin template"></a> Reference: pattern skin template INCLUDE tree

The `view` script invokes the `view` template:

    view
        twiki
            css
            viewtopbar
                %TWIKIWEB%.WebTopBar
            viewleftbar
                %WEB%.WebLeftBar
            viewtopicactionbuttons
            viewbottombar
                %TWIKIWEB%.WebBottomBar

## <a name="Logo"></a> Logo

### <a name="How can I change the web logo?"></a> How can I change the web logo?

By default the logo at the top left of each web points to the image with name `logo.gif` that is attached to each web's [[WebPreferences]]. <br /> The default variables that cause this behavior are defined in [[TWikiPreferences]].

Redefine your custom variables in [[Main.TWikiPreferences|Main/TWikiPreferences]] (to keep [[TWikiPreferences]] intact):

> * Set WEBLOGONAME = logo.gif
>        * Set WEBLOGOIMG = %PUBURLPATH%/%BASEWEB%/%WEBPREFSTOPIC%/%WEBLOGONAME%
>        * Set WEBLOGOURL = %SCRIPTURLPATH{"view"}%/%BASEWEB%/%HOMETOPIC%
>        * Set WEBLOGOALT = Home

There are 2 ways to change the logo in a web:

**Using logo.gif:**

> - Create a new image named `logo.gif` and attach it to the web's [[WebPreferences]] topic. [[PatternSkin]]'s stylesheet assumes the logo is 40px high. More about that later.
> - You can also upload the image with FTP to `/pub/YourWeb/WebPreferences/`.
> - Copy the above instructions ("Redefine your custom variables") and insert your logo name.

**Using a new filename:**

> - Attach whatever image and attach it to the web's [[WebPreferences]] topic. Then add to the [[WebPreferences]] (under _Custom web preferences_):
>
>           * Set WEBLOGONAME = your-logo-name.gif-or-png
>
> - Copy the above instructions ("Redefine your custom variables") and insert your logo name.

### <a name="How do I set a site-wide logo?"></a> How do I set a site-wide logo?

There is a bunch of site-wide logo variables in [[Main.TWikiPreferences|Main/TWikiPreferences]]: `WIKILOGOIMG`, `WIKILOGOURL` and `WIKILOGOALT`. To change only the web logo image to site-wide, in [[Main.TWikiPreferences|Main/TWikiPreferences]] set:

> * Set WEBLOGOIMG = %WIKILOGOIMG%

### <a name="My logo does not fit the top bar"></a> My logo does not fit the top bar

See [[I want to change the height of the top bar|Main/WebHome#TopBarChangeHeight]]

### <a name="I want to change the white space"></a> I want to change the white space above and below the logo

Change the table style in topic [[WebTopBar]]. The default top padding is 11px.

## <a name="Top bar"></a> Top bar

### <a name="The search box won&#39;t find topics"></a> The search box won't find topics in other webs

In [[WebTopBar]] you can find the line:

    <input type="hidden" name="web" value="%BASEWEB%" />

To search all webs, write:

> <input type="hidden" name="web" value="all" />

To search a couple of webs, for instance the webs Main and TWiki, write:

> <input type="hidden" name="web" value="Main,TWiki" />

See also: [[Search variable|TWiki/VarSEARCH]]

<a name="TopBarChangeHeight"></a>

### <a name="I want to change the height of t"></a> I want to change the height of the top bar

The top bar is 64 pixels high by default.

**Using templates:** %BR% Using either a template or a topic template, copy this definition in your custom template:

> %TMPL:DEF{"topbardimensions"}%
>     #patternTopBar,
>     #patternClearHeaderCenter,
>     #patternClearHeaderLeft,
>     #patternClearHeaderRight,
>     #patternTopBarContentsOuter {
>        height:64px; /* top bar height; make room for header columns */
>        overflow:hidden;
>     }
>     %TMPL:END%
>
> And change the number from 64px to a different value.

**Using style sheets:**

> Create a new stylesheet with above definition in it, attach it to a topic and point
>
> `USERLAYOUTURL`
>
> to that topic attachment. See
>
> [[PatternSkinCssCookbook]]
>
> about creating custom styles.

### <a name="I want to set or change the top"></a><a name="I want to set or change the top "></a> I want to set or change the top background image

The image at the top is called "header art" - commonly the top image found on blog sites. The image that is displayed by default is set by the variable `WEBHEADERART`, defined in [[TWikiPreferences]].

Redefine your custom variables in [[Main.TWikiPreferences|Main/TWikiPreferences]] (to keep [[TWikiPreferences]] intact):

> * Set WEBHEADERART = %PUBURLPATH%/%TWIKIWEB%/PatternSkin/TWiki_header.gif
>        * Set WEBHEADERBGCOLOR = somehexcolor (no quotes, for example: #ffffff)

You can also set `WEBHEADERART` per web, by defining the variable in the Web's WebPreferences.

### <a name="I want to have the web color in"></a><a name="I want to have the web color in "></a> I want to have the web color in the top bar

Redefine `WEBHEADERBGCOLOR` in [[Main.TWikiPreferences|Main/TWikiPreferences]] (to keep [[TWikiPreferences]] intact):

> * Set WEBHEADERBGCOLOR = %WEBBGCOLOR%

### <a name="I want to remove the Jump and Se"></a> I want to remove the Jump and Search boxes from the top bar

If you have localization enabled, you will also see a language dropdown box at the far right.

You can remove these items from [[WebTopBar]].

### <a name="I want to hide the top bar"></a> I want to hide the top bar

**Using templates:**

The view template is populated with page elements using template inclusions:

    %TMPL:INCLUDE{"page"}%
    %TMPL:INCLUDE{"viewtopbar"}%
    %TMPL:INCLUDE{"viewtoolbar"}%
    %TMPL:INCLUDE{"viewleftbar"}%
    %TMPL:INCLUDE{"viewrightbar"}%
    %TMPL:INCLUDE{"viewtopicactionbuttons"}%
    %TMPL:INCLUDE{"viewbottombar"}%

Each included template draws a part of the screen.%BR% Omit `%TMPL:INCLUDE{"viewtopbar"}%` to hide the top bar.

Another approach is to clear the contents of module `topbar` with an empty definition. Using either a template or a topic template, write in your custom template:

> %TMPL:INCLUDE{"view"}%
>     %TMPL:DEF{"topbar"}%%TMPL:END%
>
> and add:
>
>     %TMPL:DEF{"topbardimensions"}%#patternTopBar,
>     #patternClearHeaderCenter,
>     #patternClearHeaderLeft,
>     #patternClearHeaderRight,
>     #patternTopBarContentsOuter {
>        height:0px;
>     }%TMPL:END%

**Using style sheets:** %BR% See [[PatternSkinCssCookbookNoTopBar]]

## <a name="Left bar"></a> Left bar

### <a name="I want to hide the left bar"></a> I want to hide the left bar

**Using templates:** %BR% Omit `%TMPL:INCLUDE{"viewleftbar"}%` to hide the left bar, or in a custom template clear it using

> %TMPL:DEF{"leftbar"}%%TMPL:END%
>     %TMPL:DEF{"leftbardimensions"}%%TMPL:END%

**Using style sheets:** %BR% See [[PatternSkinCssCookbookNoLeftBar]]

### <a name="I want to make the left bar wide"></a> I want to make the left bar wider

**Using templates:** %BR%

The left bar is 12 em wide by default.

**Using templates:** %BR% Using either a template or a topic template, copy this definition in your custom template:

> %TMPL:DEF{"leftbardimensions"}%#patternOuter {
>        margin-left:12em;
>     }
>     #patternLeftBar {
>        width:12em;
>        margin-left:-12em;
>     }%TMPL:END%
>
> And change the number from 12em to a different value (3 occurrences).

## <a name="Buttons"></a> Buttons

### <a name="I want to hide the edit buttons"></a><a name="I want to hide the edit buttons "></a> I want to hide the edit buttons from certain users

It may defy the wiki-ness of your TWiki installation, but in certain circumstances it could be useful to hide the edit buttons from users that are not logged in, for instance for clients that have gotten viewing rights only.

Using either a template or a topic template, 'empty' `top:toolbarbuttons` and `topicaction` by writing:

> %TMPL:INCLUDE{"view"}%
>     %TMPL:DEF{"top:toolbarbuttons"}%%TMPL:END%
>     %TMPL:DEF{"topicaction"}%%TMPL:END%

In the user page of [[TWikiGuest]], set the cover to

> * Set COVER = customer

By default this topic is editable only by TWiki admins.

### <a name="I want to remove the History but"></a> I want to remove the History button from the bottom

All action links and buttons are defined in `viewtopicactionbuttons.tmpl`. The bottom history link is defined in DEF `action_revisions`

> %TMPL:DEF{"topicactionbuttons"}%
>     %TMPL:P{"action_activatable_edit_or_create"}%
>     %TMPL:P{"action_activatable_attach"}%
>     %TMPL:P{"action_printable"}%
>     %TMPL:P{"action_revisions"}%
>     %TMPL:P{"action_backlinks_simple"}%
>     %TMPL:P{"action_raw_or_view"}%
>     %TMPL:P{"action_activatable_raw_edit"}%
>     %TMPL:P{"activatable_more"}%
>     %TMPL:END%

To hide that link, In a custom skin view template `view.myskin.tmpl` empty `action_revisions` by replacing it with an empty string:

> %TMPL:INCLUDE{"view"}%
>     %TMPL:DEF{"action_revisions"}%%TMPL:END%

### <a name="I want to put the bottom links a"></a> I want to put the bottom links as buttons at the top

The default definition in `view.pattern.tmpl` is:

    %TMPL:DEF{"top:toolbarbuttons"}%%TMPL:P{"activatable_edit_or_create"}%%TMPL:P{"activatable_attach"}%%TMPL:END%

Create a new skin by creating a file `view.myskin.tmpl` in the `templates` directory. Write in it:

> %TMPL:INCLUDE{"view"}%
>     %TMPL:DEF{"top:toolbarbuttons"}%%TMPL:P{"history_history_link"}%%TMPL:END%

View any topic with `?skin=myskin,pattern`, or set the `SKIN` variable to `myskin,pattern`.

This will remove the Edit and Attach buttons, and place a History button at the top.

You will probably not just want to have the History button there. Other button include names are:

> create_topic_link
>     raw_edit_link
>     view_topic_link
>     activatable_attach
>     activatable_edit_or_create
>     more_link
>     activatable_printable
>     backlinks_web_link
>     backlinks_all_link
>     backlinks_link
>     history_rdiff_link
>     history_history_link
>     raw_link

## <a name="Other page parts"></a> Other page parts

### <a name="I want to insert text outside of"></a> I want to insert text outside of the topic content

PatternSkin has 2 'buckets' to write additional content to: `contentheader` and `contentfooter`, both defined in `view.pattern.tmpl`. These containers can contain text or html and are placed directly before and after the topic text.

Both modules are wrapped in CSS containers:

- `contentheader` - wrapped in `div` of class `twikiContentHeader`
- `contentfooter` - wrapped in `div` of class `twikiContentFooter`

To put contents **before** the main text, use the custom skin approach as described above.%BR% So our custom template contains:

> %TMPL:INCLUDE{"view"}%
>     %TMPL:DEF{"contentheader"}%This is the text before%TMPL:END%

Use the same procedure for contents to be put **after** the topic text:

> %TMPL:INCLUDE{"view"}%
>     %TMPL:DEF{"contentfooter"}%This is the text after%TMPL:END%

### <a name="I want to place the form at the"></a><a name="I want to place the form at the "></a> I want to place the form at the top

Pattern skin has 2 buckets for the form: `formtop` (form at the top) and `formbottom` (form at the bottom). The default definition is:

> %TMPL:DEF{"formtop"}%%TMPL:END%
>     %TMPL:DEF{"formbottom"}%%TMPL:P{"form"}%%TMPL:END%

You simply swap the bucket contents. Using either a template or a topic template, write in your custom template:

> %TMPL:INCLUDE{"view"}%
>     %TMPL:DEF{"formtop"}%%TMPL:P{"form"}%%TMPL:END%
>     %TMPL:DEF{"formbottom"}%%TMPL:END%

### <a name="I want to put the topic form in"></a><a name="I want to put the topic form in "></a> I want to put the topic form in a twisty

The attachment tables are placed in a open/close twisty. You can do the same for the topic form.

Edit `templates/formtables.pattern.tmpl` to have this code:

    %{ These templates define the form attached at the bottom of viewed page. }%

    %TMPL:DEF{"starttopicformwisty"}%%TWISTY{id="topicformlist" mode="div" remember="on" link="%MAKETEXT{"Form"}%" showimgleft="%ICONURLPATH{toggleopen}%" hideimgleft="%ICONURLPATH{toggleclose}%"}%%TMPL:END%

    %TMPL:DEF{"endtopicformwisty"}%%ENDTWISTY%%TMPL:END%

    %{ Start of form table }%
    %TMPL:DEF{FORM:display:header}%<div class="twikiForm">%TMPL:P{"starttopicformwisty"}%
    <table class='twikiFormTable' border='1'>%TMPL:P{FORM:display:header:headerrow}%%TMPL:END%

    %{ Header }%
    %TMPL:DEF{FORM:display:header:headerrow}%<tr><th class='twikiFormTableHRow twikiFirstCol' colspan='2'>
    [[%A_TITLE%]]
    </th></tr>%TMPL:END%

    %{ Each row }%
    %TMPL:DEF{FORM:display:row}%<tr valign='top'><td class='twikiFormTableRow twikiFirstCol' align='right'> %A_TITLE% </td><td>
    %A_VALUE%
    </td></tr>%TMPL:END%

    %{ Footer }%
    %TMPL:DEF{FORM:display:footer}%</table>%TMPL:P{FORM:display:footer:editlink}%
    %TMPL:P{"endtopicformwisty"}%</div><!-- /twikiForm -->%TMPL:END%

To give the twisty toggle link the same style as the attachment twisty link, add this to pattern skin's `style.css`:

    .twikiForm .twistyTrigger .twikiLinkLabel {
       font-size:122%; /* h4 size */
       font-weight:bold;
    }
