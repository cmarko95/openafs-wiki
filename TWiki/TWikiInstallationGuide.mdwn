<div>
  <ul>
    <li><a href="#TWiki Installation Guide"> TWiki Installation Guide</a><ul>
        <li><a href="#Standard Installation"> Standard Installation</a><ul>
            <li><a href="#Step 1: Create  Configure the Di"> Step 1: Create &amp; Configure the Directories</a><ul>
                <li><a href="#Step 1 for Non-Root Accounts"> Step 1 for Non-Root Accounts</a></li>
              </ul>
            </li>
            <li><a href="#Step 2: Set File Permissions"> Step 2: Set File Permissions</a></li>
            <li><a href="#Step 3: Edit the Configuration F"> Step 3: Edit the Configuration Files</a></li>
            <li><a href="#Step 4: Internationalisation Set"> Step 4: Internationalisation Setup (Optional)</a></li>
            <li><a href="#Step 5: Configure Site-Wide Emai"> Step 5: Configure Site-Wide Email Preferences</a></li>
            <li><a href="#Step 6: Finish Up from Your Brow"> Step 6: Finish Up from Your Browser</a></li>
          </ul>
        </li>
        <li><a href="#Additional Server-Level Options"> Additional Server-Level Options</a><ul>
            <li><a href="#Enabling Authentication of Users"> Enabling Authentication of Users</a></li>
            <li><a href="#WYSIWYG Editor"> WYSIWYG Editor</a></li>
          </ul>
        </li>
        <li><a href="#TWiki File System Info"> TWiki File System Info</a></li>
      </ul>
    </li>
  </ul>
</div>

# <a name="TWiki Installation Guide"></a> TWiki Installation Guide

_Installation instructions for the TWiki 01-Sep-2004 production release._

_If you are reading this on your own TWiki installation, please get the latest installation guide (TWiki:TWiki.TWikiInstallationGuide), as this often has important updates to resolve installation issues._

These installation steps are based on the **Apache** web server on **Linux**. TWiki runs on other web servers and Unix systems, and should be fine with any web server and OS that meet the [[system requirements|Main/TWikiSystemRequirements]]. Official documentation for platforms other than Linux is somewhat limited, so _please check_ the topics listed below, they include some important tips for HP-UX, Solaris, OS/390, and many other platforms.

- For Unix or Linux, check TWiki:Codev/TWikiOnUnix (install your own RCS, `diff` and `grep` tools if in doubt!) and TWiki:Codev/TWikiOnLinux.
- For Windows, check the [[WindowsInstallCookbook]].
- For MacOS X, check TWiki:Codev/TWikiOnMacOSX.
- To install TWiki on SourceForge, for use on a software development project, read TWiki:Codev/TWikiOnSourceForge
- For other platforms, see TWiki:Codev/TWikiOn, and search the TWiki:Codev and TWiki:Support webs for other installation notes.
- If you need help, ask a question in the TWiki:Support web

<a name="StandardInstallation"></a>

## <a name="Standard Installation"></a> Standard Installation

Download the TWiki 01-Sep-2004 distribution in Unix ZIP format from <http://TWiki.org/download.html>. Please review the [[AdminSkillsAssumptions]] before you install TWiki.

### <a name="Step 1: Create  Configure the Di"></a> Step 1: Create &amp; Configure the Directories

%X% **NOTE:** _If you don't have access to your Web server configuration files - for example, if you're installing on an ISP-hosted account, or you don't have administrator privileges on your intranet server - use the [[alternative Step 1|Main/WebHome#StepOneB]] instead._

- Create directory `/home/httpd/twiki` and [unzip](http://www.info-zip.org/pub/infozip/UnZip.html) the TWiki distribution into this directory.
- The `twiki/bin` directory of TWiki must be set as a cgi-bin directory. Add `/home/httpd/twiki/bin` to file `httpd.conf` (typcially located in `/etc/httpd/`) with only `ExecCGI` option.
- The `twiki/pub` directory of TWiki must be set so that it is visible as a URL. Add `/home/httpd/twiki` to file `httpd.conf` with normal access options (copy from `/home/httpd/html` ).
- Now add `ScriptAlias` for `/twiki/bin` and `Alias` for `/twiki` to file `httpd.conf` . <br /> %X% **NOTE:** The `ScriptAlias` **_must_** come before the `Alias`, otherwise, Apache will fail to correctly set up `/twiki/bin/`, by treating it as just another subdirectory of the `/twiki/` alias.
- The `twiki/data` and `twiki/templates` directories should be set so that they are **not** visible as URLs. Add them to `httpd.conf` with `deny from all`.

> **Example `httpd.conf` entries:**
>
>      ScriptAlias /twiki/bin/ "/home/httpd/twiki/bin/"
>      Alias /twiki/ "/home/httpd/twiki/"
>      <Directory "/home/httpd/twiki/bin">
>     	 Options +ExecCGI
>     	 SetHandler cgi-script
>     	 Allow from all
>      </Directory>
>      <Directory "/home/httpd/twiki/pub">
>     	 Options FollowSymLinks +Includes
>     	 AllowOverride None
>     	 Allow from all
>      </Directory>
>      <Directory "/home/httpd/twiki/data">
>     	 deny from all
>      </Directory>
>      <Directory "/home/httpd/twiki/templates">
>     	 deny from all
>      </Directory>

- Restart Apache by `service httpd restart` (or as appropriate to your flavor of UNIX or Linux).
- Test that the `twiki/bin` directory is CGI-enabled by trying visiting it in your browser:
  - Enter the URL for the `bin` directory, `http://yourdomain.com/twiki/bin/`.
  - Your settings are OK if you get a message like `"Forbidden. You don't have permission to access /twiki/bin/ on this server"`.
  - Settings are NOT correct if you get something like `"Index of /twiki/bin"` - recheck your `httpd.conf` file.

- _Go directly to [[Step 2|Main/WebHome#StepTwo]]..._

<a name="StepOneB"></a>

#### <a name="Step 1 for Non-Root Accounts"></a> Step 1 for Non-Root Accounts

To install TWiki on a system where you don't have Unix/Linux root (administrator) privileges, for example, on a hosted Web account or an intranet server administered by someone else:

- Download and unzip TWiki on your local PC
- Using the table below, create a directory structure on your host server
- Upload the TWiki files by FTP (transfer as _text_ except for the image files in `pub`)

> <table border="1" cellpadding="0" cellspacing="0">
>   <tr>
>     <th bgcolor="#99CCCC"><strong> TWiki dir: </strong></th>
>     <th bgcolor="#99CCCC"><strong> What it is: </strong></th>
>     <th bgcolor="#99CCCC"><strong> Where to copy: </strong></th>
>     <th bgcolor="#99CCCC"><strong> Example: </strong></th>
>   </tr>
>   <tr>
>     <td><code>twiki</code></td>
>     <td> start-up pages </td>
>     <td> root TWiki dir </td>
>     <td><code>/home/smith/twiki/</code></td>
>   </tr>
>   <tr>
>     <td><code>twiki/bin</code></td>
>     <td> CGI bin </td>
>     <td> CGI-enabled dir </td>
>     <td><code>/home/smith/twiki/bin</code></td>
>   </tr>
>   <tr>
>     <td><code>twiki/lib</code></td>
>     <td> library files </td>
>     <td> same level as <code>twiki/bin</code></td>
>     <td><code>/home/smith/twiki/lib</code></td>
>   </tr>
>   <tr>
>     <td><code>twiki/pub</code></td>
>     <td> public files </td>
>     <td> htdoc enabled dir </td>
>     <td><code>/home/smith/twiki/pub</code></td>
>   </tr>
>   <tr>
>     <td><code>twiki/data</code></td>
>     <td> topic data </td>
>     <td> dir secure from public access </td>
>     <td><code>/home/smith/twiki/data</code></td>
>   </tr>
>   <tr>
>     <td><code>twiki/templates</code></td>
>     <td> web templates </td>
>     <td> dir secure from public access </td>
>     <td><code>/home/smith/twiki/templates</code></td>
>   </tr>
> </table>

**_Note:_** Don't worry if you are not able to put the `twiki/lib` directory at the same level as the `twiki/bin` directory (e.g. because CGI `bin` directories can't be under your home directory and you don't have root access). You can create this directory elsewhere and configure the `/twiki/bin/setlib.cfg` file (done in Step 3)

<a name="StepTwo"></a>

### <a name="Step 2: Set File Permissions"></a> Step 2: Set File Permissions

- Make sure Perl 5 and the Perl CGI library are installed on your system. The default location of Perl is `/usr/bin/perl`. If it's elsewhere, change the path to Perl in the first line of each script in the `twiki/bin` directory, or create a symbolic link from `/usr/bin/perl`.
  - **IMPORTANT:**
    - On ISP-hosted accounts (and some intranet servers), Perl CGI scripts may require a `.cgi` extension to run. Some systems need `.pl`, the regular Perl extension. Rename all `twiki/bin` scripts if necessary.
    - Alternatively, you might try creating a file `twiki/bin/.htaccess` that contains the single line `SetHandler cgi-script`, which tells Apache to treat all files in this directory as CGI scripts.
- Set the file permission of all Perl scripts in the `twiki/bin` directory as executable to `-rwxr-xr-x` (755).
- To be able to edit the Perl scripts and `.tmpl` files it is necessary to `chown` and `chgrp -R twiki` so all the files have the owner you want.
- %H% This Guide assumes user `nobody` ownership for all files manipulated by the CGI scripts (executed by the Web server), and user `twiki` for all other files. You can:
  - replace `nobody` with another user if your server executes scripts under a different name (ex: default for Debian is `www-data`).
    - %T% **HINT:** Run the `testenv` script from your browser: `http://yourdomain.com/twiki/bin/testenv`. It will show you the user name of the CGI scripts, a table listing all CGI environment variables, and a test of your `twiki/lib/TWiki.cfg` configuration file (you'll configure that in a minute).
  - replace user `twiki` with your own username
- Set permissions manually.
  - Set the permission of all **files** below `twiki/data` so that they are writable by user `nobody`. A simple way is to `chmod` them to `-rw-rw-r--` (664) and to `chown` them to `nobody`.
  - Set the permission of the `twiki/data` **directory** and its **subdirectories** so that files in there are writable by user `nobody`. A simple way is to chmod them to `drwxrwxr-x` (775) and to `chown` them to `nobody`.
  - Set the permission of the `twiki/pub` directory and all its subdirectories so that files in there are writable by user `nobody`. A simple way is to `chmod` them to `drwxrwxr-x` (775) and to `chown` them to `nobody`.
  - %H% The `twiki/data/*/*.txt,v` RCS repository files in the installation package are locked by user `nobody`. If your CGI scripts are **_not_** running as user `nobody`, it's not possible to check in files (you'll see that the revision number won't increase after saving a topic). In this case, you need to unlock all repository files (check the RCS man pages) and lock them with a different user, such as `www-data`, or delete them all - new files will be automatically created the first time each topic is edited. You have two options to change ownership of the RCS lock user:
    - Run the `testenv` script from your browser; in the %BROWN% **Fix** %ENDCOLOR% line you can <u>relock</u> all the rcs files
    - Alternatively, run this in your shell: %BR% `cd twiki/data` %BR% `find . -name *.v~ -exec perl -pi~ -e '$. <= 10 && s/nobody:/www-data:/ ' {} ;`

### <a name="Step 3: Edit the Configuration F"></a> Step 3: Edit the Configuration Files

- Edit the file `/twiki/bin/setlib.cfg`
  - Set `$twikiLibPath` to the absolute file path of your `/twiki/lib` as seen by the web server.
  - %X% **_Attention:_** Do **not** leave it as a relative `"../lib"` path or Plugins might fail to initialize properly
  - You can also edit `$localPerlLibPath` if you are not root and need to install additional CPAN modules, but can't update the main Perl installation files on the server. Just set this variable to the full pathname to your local lib directory, typically under your home directory.
  - %X% **_Attention:_** If you are running TWiki on Apache 2.0 on Unix you might experience cgi scripts to hang forever. This is a known Apache 2.0 bug. See details and woraround in the `setlib.cfg` file.
- Edit the file `twiki/lib/TWiki.cfg`, setting the variables to your needs.
  - Set the file extension in the `$scriptSuffix` variable to `cgi` or `pl` if required.
  - RCS - revision control system to store revision of topics and attachments. You can use RCS executables or a version of RCS written in Perl, note that as the time of writing (Apr 2002) the Perl version has not been widely tested, so if you want to put up a live site the RCS executables are recommended.
    - Set `$storeTopicImpl = "RcsWrap";` for the RCS executables and make sure RCS is installed. Set `$rcsDir` in `twiki/lib/TWiki.cfg` to match the location of your RCS binaries. You can check this by issuing the command `rcs` at the prompt, it should result in something like `"rcs: no input file"`.
      - Check that you have GNU `diff`, by typing `diff -v` - an error indicates you have a non-GNU diff, so install the GNU `diffutils` package and make sure that `diff` is on the PATH used by TWiki (see `$safeEnvPath` in the `TWiki.cfg` file).
    - Set `$storeTopicImpl = "RcsLite";` for the Perl based RCS
- **Security issue:** Directories `twiki/data` , `twiki/templates` and all their subdirectories should be set so that they are **_not_** visible through URLs. (Alternatively, move the directories to a place where they are not visible, and change the variables in `twiki/lib/TWiki.cfg` accordingly)
- Test your settings by running the `testenv` script from your browser: `http://yourdomain.com/twiki/bin/testenv`. Check if your `twiki/lib/TWiki.cfg` configuration file settings are correct.

### <a name="Step 4: Internationalisation Set"></a> Step 4: Internationalisation Setup (Optional)

By default, TWiki is configured to support US ASCII letters (no accents) in [[WikiWords]], and ISO-8859-1 (Western European) characters in page contents. If that's OK for you, skip this step.

If your Wiki will be used by non-English speakers, TWiki can be configured for Internationalisation ('I' followed by 18 letters, then 'N', or _I18N_). Specifically, TWiki will support suitable accented characters in [[WikiWords]] (as well as languages such as Japanese or Chinese in which [[WikiWords]] do not apply), and to support virtually any character set in the contents of pages. **_NOTE:_** _TWiki does not currently support UTF-8, so you are advised **not** to use this - however, improved UTF-8 support is [under development](http://twiki.org/cgi-bin/view/Codev/ProposedUTF8SupportForI18N)._

To configure internationalisation suppport:

1. Edit the `TWiki.cfg` file's Internationalisation section to set the `$useLocale` parameter to `1`. TWiki will now use the [[I18N]] parameters set in the rest of this section.
2. Type the Unix/Linux command `locale -a` to find a suitable 'locale' for your use of TWiki. A locale that includes a dot followed by a character set is recommended, e.g. `pl_PL.ISO-8859-2` for Poland. Consult your system administrator if you are not sure which locale to use.
3. In `TWiki.cfg`, set the `$siteLocale` parameter to your chosen locale, e.g. `pl_PL.ISO-8859-2` for Poland.
4. Check your setup using `testenv` (download the latest `testenv` from TWiki:Support/SupportGuidelines if possible) - this provides some diagnostics for [[I18N]] setup, and in particular checks that your locale can be used successfully.
5. If you are using Internet Explorer or Opera, configure your browser to not send URLs encoded with UTF-8
  - Internet Explorer 5.0 or higher: in _Tools | Options | Advanced_, uncheck 'always send URLs as UTF-8', then close all IE windows and restart IE.
  - Opera 6.x or higher: in _Preferences | Network | International Web Addresses_, uncheck 'encode all addresses with UTF-8'.
  - **_NOTE:_** _If this configuration change is not acceptable, consider installing a TWiki beta release (19 Jan 2004 or later), which fully supports UTF-8 URLs._
6. Try out your TWiki by creating pages in the Sandbox web that use international characters in [[WikiWords]] and checking that searching, [[WebIndex]], Ref-By and other features are working OK.

If international characters in [[WikiWords]] do not seem to work, and you are on Perl 5.6 or higher, you may need to set the `TWiki.cfg` parameter `$localeRegexes` to 0 - this disables some features but enables TWiki to work even if your system has locales that do not work. Then, set the `$upperNational` and `$lowerNational` parameters to the valid upper and lower case accented letters for your locale.

- **_NOTE:_** _You will need to do the above workaround for Windows based servers (whether using Cygwin or ActiveState Perl), since Perl locales are not working on Windows as of Feb 2004._

If international characters in [[WikiWords]] aren't working, and you are on Perl 5.005 with working locales, keep `$useLocale` set to 1 and set `$localeRegexes` to 0, then set `$upperNational` and `$lowerNational` - if `testenv` generates the lists of characters for you, your locales are working so there is no need to set `$localeRegexes` to 0 in this case. See the comments in `TWiki.cfg` for more information.

### <a name="Step 5: Configure Site-Wide Emai"></a> Step 5: Configure Site-Wide Email Preferences

- Edit the [[TWikiPreferences]] topic in the TWiki web (by pointing your browser to http://yourdomain.com/twiki/bin/view/TWiki/TWikiPreferences) to set the `WIKIWEBMASTER` email address, and other email settings required for registration and [[WebChangesAlert]] to work:
  - `WIKIWEBMASTER` should be set to the email address of the TWiki administrator
  - `SMTPMAILHOST` is typically set on Windows or other non-Unix/Linux systems, where `sendmail` or similar is not available. When this is set and the Perl module <code>**Net::SMTP**</code> is installed, TWiki will connect to this SMTP server (e.g. `mail.yourdomain.com`) to send email for user registration and [[WebChangesAlerts]]. If you do have a sendmail-type program, leave `SMTPMAILHOST` unset so that the external sendmail program is used instead (defined by <code>**$mailProgram**</code> in <code>**TWiki.cfg**</code>).
  - `SMTPSENDERHOST` is optional, and set to the domain name sending the email (e.g. `twiki.yourdomain.com`). For use where the SMTP server requires that you identify the TWiki server sending mail. If not set, <code>**Net::SMTP**</code> will guess it for you.
- You may want to set up other [[TWikiPreferences]] later on.
- To enable the [[WebChangesAlerts]] (email notifications) you need to read about cron in the topic [[TWikiSiteTools]].

### <a name="Step 6: Finish Up from Your Brow"></a> Step 6: Finish Up from Your Browser

- Point your Web browser at `http://yourdomain.com/twiki/bin/view` and start TWiki-ing away!
  - %T% Or, point to `http://yourdomain.com/twiki/` to get the pre-TWiki `index.html` page, with a link to the `view` script. Customize this page if you want a public intro screen with a login link, instead of immediately calling up the .htaccess login dialog by going directly to `view`.
- Edit the [[WebPreferences]] topic in each web, if necessary: set individual `WEBCOPYRIGHT` messages, and other preferences.
- Enable email notification of topic changes - [[TWikiSiteTools]] has more.
- Edit the [[WebNotify]] topic in all webs and add the users you want to notify.
- Add the TWiki:Main/PoweredByTWikiLogo to your [[Main.WebHome|Main/WebHome]] topic.
- You can add new `%VARIABLES%`. Define site-level variables in the [[TWikiPreferences]] topic. See also: [[TWikiVariables]].

That's it for the standard installation of TWiki. Read on for server-level customization options.

## <a name="Additional Server-Level Options"></a> Additional Server-Level Options

With your new TWiki installation up and running, you can manage most aspects of your site from the browser interface. Only a few functions require access to the server file system, via Telnet or FTP. You can make these server-level changes during installation, and at any time afterwards.

<a name="AuthenticationOfUsers"></a>

### <a name="Enabling Authentication of Users"></a> Enabling Authentication of Users

- If TWiki is installed on a non-authenticated server - not using SSL - and you'd like to authenticate users:
  1. **Rename** file `.htaccess.txt` in the `twiki/bin` directory to `.htaccess` and change it to your needs. For details, consult the HTTP server documentation (for Apache server: [[1]](http://www.apache.org/docs/mod/directives.html), [[2]](http://systems.mcs.kent.edu/info/web_help/htaccess/)). In particular, the following <font>red</font> part needs to be configured correctly: <br /><code>Redirect <font>/urlpathto/twiki/index.html</font> http://<font>yourdomain.com/urlpathto/twiki/bin/</font>view</code><br /><code>AuthUserFile <font>/filepathto/twiki/data/</font>.htpasswd</code><br /><code>ErrorDocument 401 <font>/urlpathto/twiki/bin/</font>oops/TWiki/TWikiRegistration?template=oopsauth</code>
    - %X% **NOTE:** If you had to add a `.cgi` or `.pl` file extension to the `bin` scripts, make sure to do the same for `edit`, `view`, `preview`, and all the other script names in `.htaccess`.
    - %H% The browser should ask for login name and password when you click on the <u>Edit</u> link. In case `.htaccess` does not have the desired effect, you need to enable it: Add "AllowOverride All" to the Directory [[3]](http://httpd.apache.org/docs/mod/core.html#directory) section of `access.conf` for your `twiki/bin` directory.
      - **This applies only if you have root access:** on hosted accounts, you shouldn't have this problem - otherwise, email tech support.
    - %X% **NOTE:** In the TWiki distribution package, the `twiki/data/.htpasswd.txt` file contains several TWiki core team user accounts and a guest user account. You probably want to remove those accounts by deleting the entries in `.htpasswd`. Do not remove the guest user if you want to allow guest logins.
  2. TWiki now supports several Password file format/encoding methods for Apache. Once you know what method is used by your Appache server, you can configure TWiki to create compatible .htpasswd entries by editing the `$htpasswdFormatFamily`, `$htpasswdEncoding` and `$htpasswdFilename` in the TWiki.cfg file. The supported options are htpasswd:plain, htpasswd:crypt, htpasswd:sha1, htdigest:md5
  3. **Copy** the [[TWikiRegistrationPub]] topic to [[TWikiRegistration]], overwriting old version of TWikiRegistration. Do that by either editing the topics in theTWiki web, or by renaming the `.txt` and `.txt,v` files in the `twiki/data/TWiki` directory.
- Customization:
  - You can customize the registration form by deleting or adding input tags. The `name=""` parameter of the input tags must start with: `"Twk0..."` (if this is an optional entry), or `"Twk1..."` (if this is a required entry). This ensures that the fields are carried over into the user home page correctly.
  - You can customize the default user home page in [[NewUserTemplate]]. The same variables get expanded as in the [[template topics|Main/TWikiTemplates#Template_Topics]]
- Register yourself in the [[TWikiRegistration]] topic.
  - %X% **NOTE:** When a user registers, a new line with the username and encrypted password is added to the `data/.htpasswd` file. The `.htpasswd` file that comes with the TWiki installation includes user accounts for TWiki core team members that are used for testing on TWiki.org. You can edit the file and delete those lines.
- Create a new topic to check if authentication works.
- Edit the [[TWikiAdminGroup]] topic in the TWiki:Main web to include users with system administrator status.
- Edit the [[TWikiPreferences]] topic in the TWiki:TWiki web to set access privileges.
- Edit the [[WebPreferences]] topic in each web, if necessary: set access priviliges.

### <a name="WYSIWYG Editor"></a> WYSIWYG Editor

At this time, TWiki does not ship with an "what you see is what you get" editor. TWiki:Codev/IntegrateHtmlAreaEditor describes how to integrate an HTML editor.

%X% **NOTE:** User home topics are located in the %WIKITOOLNAME%.Main web - don't try to move them or create them in other webs. From any other web, user signatures have to point to %WIKITOOLNAME%.Main web, using a `Main.UserName` or `%MAINWEB%.UserName` format. (The `%MAINWEB%` variable is an advantage if you ever change the Main web name, but the standard `Main.UserName` is easier for users to enter, which is the bottom line!

## <a name="TWiki File System Info"></a> TWiki File System Info

See [[Appendix A: TWiki File System|Main/AppendixFileSystem]] for an installed system snapshot and descriptions of all files in the TWiki 01-Sep-2004 distribution.

-- TWiki:Main/PeterThoeny - 15 Aug 2004 %BR% -- TWiki:Main/MikeMannix - 16 May 2002
