<div>
  <ul>
    <li><a href="#TWiki Installation Guide"> TWiki Installation Guide</a><ul>
        <li><a href="#Overview"> Overview</a></li>
        <li><a href="#Standard Installation"> Standard Installation</a><ul>
            <li><a href="#Step 1: Create  Configure the Di"> Step 1: Create &amp; Configure the Directories</a></li>
            <li><a href="#Step 2: Check the Server Directo"> Step 2: Check the Server Directory Settings</a></li>
            <li><a href="#Step 3: Enable Perl File Permiss"> Step 3: Enable Perl File Permissions</a></li>
            <li><a href="#Step 4: Set the Main Configurati"> Step 4: Set the Main Configuration File</a></li>
            <li><a href="#Step 5: Finish Up from Your Brow"> Step 5: Finish Up from Your Browser</a></li>
          </ul>
        </li>
        <li><a href="#Additional Server-Level Options"> Additional Server-Level Options</a><ul>
            <li><a href="#Creating a New Web"> Creating a New Web</a></li>
            <li><a href="#Adding Variables  Rendering Rule"> Adding Variables &amp; Rendering Rules </a></li>
            <li><a href="#Enabling Basic Authentication (."> Enabling Basic Authentication (.htaccess)</a></li>
          </ul>
        </li>
        <li><a href="#TWiki File System Info"> TWiki File System Info</a></li>
      </ul>
    </li>
  </ul>
</div>

# <a name="TWiki Installation Guide"></a> TWiki Installation Guide

_Clean install of the current public release (01-Sep-2001)_

## <a name="Overview"></a> Overview

These installation steps use the Apache web server on Linux as an example. TWiki should run on other web servers and Unix systems as well. (TWiki on Windows is possible, but has not been well-documented. More on that at <http://TWiki.org/cgi-bin/view/Codev/TWikiOnWindows>.)

- **_NOTE:_** This Installation Guide assumes the following:

- - **User `nobody=`** is used for all files manipulated by the CGI scripts (executed by the Web server), and user =twiki for all other files. Replace user `nobody` with another user if your Web server executes scripts under a different name (default for Debian is `www-data`). Also, you can substitute user `twiki` with your own username.

- - **You have control** over the Web server configuraton files. In case you don't - you may be installing on an ISP-hosted server - follow the steps but use these directories instead:

<table border="1" cellpadding="0" cellspacing="0">
  <tr>
    <th bgcolor="#99CCCC"><strong> TWiki dir: </strong></th>
    <th bgcolor="#99CCCC"><strong> What it is: </strong></th>
    <th bgcolor="#99CCCC"><strong> Where to copy: </strong></th>
    <th bgcolor="#99CCCC"><strong> Example: </strong></th>
  </tr>
  <tr>
    <td><code>twiki/bin</code></td>
    <td> CGI bin </td>
    <td> cgi-bin enabled dir </td>
    <td><code>/home/smith/public_html/cgi-bin/twiki</code></td>
  </tr>
  <tr>
    <td><code>twiki/pub</code></td>
    <td> public files </td>
    <td> htdoc enabled dir </td>
    <td><code>/home/smith/public_html/pub</code></td>
  </tr>
  <tr>
    <td><code>twiki/data</code></td>
    <td> topic data </td>
    <td> outside of htdoc tree (for security) </td>
    <td><code>/home/smith/twiki/data</code></td>
  </tr>
  <tr>
    <td><code>twiki/templates</code></td>
    <td> web templates </td>
    <td> outside of htdoc tree (for security) </td>
    <td><code>/home/smith/twiki/templates</code></td>
  </tr>
</table>

Read <http://TWiki.org/cgi-bin/view/Codev/SourceForgeHowTo> in case you want to install TWiki on SourceForge.

## <a name="Standard Installation"></a> Standard Installation

Request and download the TWiki 01-Sep-2001 distribution in Unix ZIP format from <http://TWiki.org/download.html>.

### <a name="Step 1: Create  Configure the Di"></a> Step 1: Create &amp; Configure the Directories

- Create directory `/home/httpd/twiki` and unzip the TWiki distribution into this directory.
- The `twiki/bin` directory of TWiki must be set as a cgi-bin directory. Add `/home/httpd/twiki/bin` to file `/etc/httpd/httpd.conf` with only `ExecCGI` option.
- The `twiki/pub` directory of TWiki must be set so that it is visible as a URL. Add `/home/httpd/twiki` to file `httpd.conf` with normal access options (copy from `/home/httpd/html` ).
- Now add `ScriptAlias` for `/twiki/bin` and `Alias` for `/twiki` to file `httpd.conf` . <br />**_Note:_** The `ScriptAlias` **must** come before the `Alias` in Apache, otherwise it will fail to correctly set up `/twiki/bin/` , due to the fact that it sees that as being just another subdirectory of the `/twiki/` alias. <br />

> **Example `httpd.conf` entries:**
>
>      ScriptAlias /twiki/bin/ "/home/httpd/twiki/bin/"
>      Alias /twiki/ "/home/httpd/twiki/"
>      <Directory "/home/httpd/twiki/bin">
>     	 Options +ExecCGI
>     	 SetHandler cgi-script
>     	 Allow from all
>      </Directory>
>      <Directory "/home/httpd/twiki/pub">
>     	 Options FollowSymLinks +Includes
>     	 AllowOverride None
>     	 Allow from all
>      </Directory>

### <a name="Step 2: Check the Server Directo"></a> Step 2: Check the Server Directory Settings

- Restart Apache by `/etc/rc.d/rc5.d/S85httpd restart` .
- Test if the `twiki/bin` directory is cgi-enabled:
  - Enter the URL of that directory into your browser ( `http://your.domain.com/twiki/bin` ). It is not set correctly as cgi-bin in case you get something like `"Index of /twiki/bin"` . It is OK if you get a message like `"Forbidden. You don't have permission to access /twiki/bin/ on this server."`
  - Execute the `testenv` script from your browser ( `http://your.domain.com/twiki/bin/testenv` ). It shows a table with all CGI environment variables and tests the settings in your <code>**twiki/bin/wikicfg.pm**</code> configuration file.

### <a name="Step 3: Enable Perl File Permiss"></a> Step 3: Enable Perl File Permissions

- Make sure Perl 5 and the Perl CGI library are installed on your system. Default location of Perl executable is `/usr/bin/perl`. In case Perl is installed in a different location, the first line of all Perl scripts in the <code>**twiki/bin**</code> directory must be changed (alternatively you can create a symbolic link from <code>**/usr/bin/perl**</code> ).
  - **IMPORTANT:** On most ISP virtual domain accounts, Perl CGI scripts require a <code>**.cgi**</code> extension to run. Some systems need <code>**.pl**</code>, the regular Perl extension. Change all <code>**twiki/bin**</code> scripts appropriately if necssary.
- To be able to edit the Perl scripts and <code>**.tmpl**</code> files it is necessary to <code>**chown**</code> and <code>**chgrp -R twiki**</code> so all the files have the owner you want.
- The scripts execute as <code>**nobody**</code>. Set the file permission of all Perl scripts in the <code>**twiki/bin**</code> directory as executable to <code>**-rwxr-xr-x**</code> (755).
- Set the permission of all files below `twiki/data` so that they are writable by user `nobody`. A simple way is to <code>**chmod**</code> them to <code>**-rw-rw-rw-**</code> (666).
- Set the permission of the <code>**twiki/data**</code> directory and its subdirectories so that files in there are writable by user <code>**nobody**</code>. A simple way is to chmod them to <code>**drwxrwxrwx**</code> (777).
- Set the permission of the `twiki/pub` directory and all its subdirectories so that files in there are writable by user `nobody`. A simple way is to chmod them to <code>**drwxrwxrwx**</code> (777).

### <a name="Step 4: Set the Main Configurati"></a> Step 4: Set the Main Configuration File

- Edit the file <code>**twiki/bin/wikicfg.pm**</code> and set the variables at the beginning of the file to your needs.
  - Set the file extension in the `$scriptSuffix` variable to <code>**cgi**</code> or <code>**pl**</code> if required.
  - Make sure RCS is installed. Set `$rcsDir` in `twiki/bin/wikicfg.pm` to mach the location of your RCS binaries.
- Note in case the cgi scripts are **_not_** running as user `nobody`: The `*,v` RCS repository files delivered with the installation package are locked by user `nobody` . In case the user is different (e.g. `www-data` ), it is not possible to check in files, this has the effect that the topic version number does not increase when saving a topic. In this case you need to unlock all repository files and lock them as user `www-data` (check the rcs man pages), or simply delete all the repository files. A simple way to switch the locker of the RCS files is to use sed: <br />`for f in *,v; do sed 's/nobody\:/www-data\:/' $f > x; mv x $f; done`
- **Security issue:** Directories `twiki/data` , `twiki/templates` and all its subdirectories should be set so that they are **not** visible as a URL. (Alternatively, move the directries to a place where they are not visible, and change the variables in `twiki/bin/wikicfg.pm` accordingly)
- Enable email notification of topic changes, [[Notification of Changes|Main/TWikiDocumentation#TWiki_Notification_of_Changes]] has more.
- Add the [TWiki:Main.PoweredByTWikiLogo](http://TWiki.org/cgi-bin/view/Main/PoweredByTWikiLogo) to your [[WebHome]] topic.

### <a name="Step 5: Finish Up from Your Brow"></a> Step 5: Finish Up from Your Browser

- Point your Web browser at <code>**http://your.domain.com/twiki/bin/view**</code> and start TWiki-ing away!
- Edit the [[TWikiPreferences]] topic in the TWiki:TWiki web to set the WIKIWEBMASTER email address, the WEBCOPYRIGHT message and other preferences.
- If you use `.htaccess`, edit the file and add the file extension to `edit`, `view`, `preview`, etc.
- Edit the [[WebNotify]] topic in all webs and set the users you want to notify.

That's it for the standard virgin installation of TWiki. Read on to learn how to customize TWiki.

## <a name="Additional Server-Level Options"></a> Additional Server-Level Options

Complete a Standard Installation and your new TWiki site should be up and running. You can develop and manage most aspects of your site from the browser interface. Core set-up functions require direct access to the server file system, via Telnet or FTP. You can make server-level site changes during installation, or at any time afterwards.

<a name="CreateWeb"></a>

### <a name="Creating a New Web"></a> Creating a New Web

- To create a new web:
  1. **Create** a new web data directory under `twiki/data` and check the file permission of the directory.
    - Use a name consisting of characters `A..Z` , `a..z` but **_not_** in [[WikiNotation]].
  2. **Copy** all files from the `twiki/data/_default` directory to the new data directory, preserving the original files' owner, group and permissions (on Unix, use `cp -p`). The data files must be writable by the owner the CGI scripts are running on (usually, `nobody`).
    - **_Hint:_** You can set permissions of `.txt` and `.txt,v` files to `-rw-rw-rw-` (666) and then edit the topic using your browser; RCS will restore the file permissions correctly when saving the topic.
  3. **Add** the new web to the web list (visible in the upper right corner of each topic) by editing the site-level preferences, [[TWikiPreferences]]:
    - Add the new web to the `%WIKIWEBLIST%` variable.
  4. **Update** the web settings by editing the WebPreferences topic of the new web:
    - Customize the `%WEBTOPICLIST%` variable to contain the web-specific links you prefer.
    - Set the WEBBGCOLOR variable to a color. The number represents the unique color for the web.
    - Set Plugins, access privileges, custom variables, other web-level options (ex: `%WEBCOPYRIGHT%` can be set for an individual web).
  5. **Add** the new web to the color-coded web directory table by editing the [[TWikiWebsTable]] topic.
  6. **Test** the new web: view pages, create a new page.

- That's it for a basic new web set-up. You can also further customize the web:
  - Create customized templates in the new templates directory (otherwise, templates are inherited from `twiki/templates`).
    - **_NOTE:_** For web-specific templates in a `templates` subdirectory, ex: `twiki/templates/someweb`.
  - Create [[Form Templates|Main/TWikiDocumentation#TWiki_Form_Templates]] to add form-based page input that's stored separately from the main free-form topic text.

- **_NOTE:_** User home topics are located in the %WIKITOOLNAME%.Main web - don't try to move them or create them in other webs. From any web you can refer to users located in the %WIKITOOLNAME%.Main web with `Main.UserName` or `%MAINWEB%.UserName` - using the `%MAINWEB%` variable is preferable, particularly if you might change the Main web name.

### <a name="Adding Variables  Rendering Rule"></a> Adding Variables &amp; Rendering Rules

- You can add new rendering rules or new `%VARIABLES%`. To insure an easy upgrade of TWiki, it is recommended to do this sort of customization with [[TWiki Plugins|Main/TWikiDocumentation#TWiki_Plugins]] and the Plugins API.

### <a name="Enabling Basic Authentication (."></a> Enabling Basic Authentication (.htaccess)

- If you are on a non-authenticated server - not using SSL - and you would like to authenticate users:
  1. **Rename** file `.htaccess.txt` in the `twiki/bin` directory to `.htaccess` and change it to your needs. For details, consult the HTTP server documentation (for Apache server: [[1]](http://www.apache.org/docs/mod/directives.html), [[2]](http://www.mcs.kent.edu/system/web_help/htaccess/introduction.html)). In particular, the following <font>red</font> part needs to be configured correctly: <br /><code>Redirect <font>/urlpath/to/TWiki/index.html</font> http://<font>your.domain.com/urlpath/to/TWiki/bin/</font>view</code><br /><code>AuthUserFile <font>/filepath/to/TWiki/data/</font>.htpasswd</code><br /><code>ErrorDocument 401 <font>/urlpath/to/TWiki/bin/</font>oops/TWiki/TWikiRegistration?template=oopsauth</code>
    - **_NOTE:_** The browser should ask for login name and password when you click on the <u>Edit</u> link. In case `.htaccess` does not have the desired effect you need to enable it: Add "AllowOverride All" to the Directory section of `access.conf` for your `twiki/bin` directory.
  2. **Copy** the [[TWikiRegistrationPub]] topic to [[TWikiRegistration]]. Do that by either editing the topics in theTWiki web, or by renaming the `.txt` and `.txt,v` files in the `twiki/data/TWiki` directory.
    - **_NOTE:_** You can customize the registration form if needed, like deleting or adding input tags. The `name=""` parameter of the input tags must start with: `"Twk0..."` (if this is an optional entry), or `"Twk1..."` (if this is a required entry). This will ensure that the fields are processed correctly.

- - A new line containing user name and encrypted password gets added to the `data/.htpasswd` file when a users registers. The file that comes with the TWiki installation contains a few user accounts of TWiki core team members (needed for testing). You can edit the file and delete those lines.

## <a name="TWiki File System Info"></a> TWiki File System Info

See [[A: TWiki File System|Main/TWikiDocumentation#FileSystem]] for an installed system snapshot and descriptions of all files in the TWiki 01-Sep-2001 distribution.

-- [[MikeMannix]] - 07 Sep 2001 <br />
