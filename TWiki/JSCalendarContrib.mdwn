# <a name="%TOPIC%"></a><a name=" %TOPIC%"></a> %TOPIC%

![](http://www.dementia.org/twiki//view/screenshot.gif)

%SHORTDESCRIPTION%

<div>
  <ul>
    <li><a href="#Summary of Contents"> Summary of Contents</a></li>
    <li><a href="#Detailed Documentation"> Detailed Documentation</a><ul>
        <li><a href="#TWiki::Contrib::_JSCalendarContr"> TWiki::Contrib::JSCalendarContrib::renderDateForEdit($name, $value, $format [, \%cssClass]) -&gt; $html</a></li>
        <li><a href="#TWiki::Contrib::_JSCalendarContr"> TWiki::Contrib::JSCalendarContrib::addHEAD($setup)</a></li>
        <li><a href="#Using the Calendar in user forms"> Using the Calendar in user forms</a></li>
        <li><a href="#Installation Instructions"> Installation Instructions</a></li>
        <li><a href="#Contrib Info"> Contrib Info</a></li>
      </ul>
    </li>
  </ul>
</div>

## <a name="Summary of Contents"></a> Summary of Contents

This module packages the [Mishoo JSCalendar](http://dynarch.com/mishoo/calendar.epl) Javascript in a form suitable for use with TWiki.

## <a name="Detailed Documentation"></a> Detailed Documentation

Read [the Mishoo documentation](http://www.dementia.org/twiki//view/doc/html/reference.html) or [visit the demo page](http://www.dementia.org/twiki//view) for detailed information on using the calendar widget.

This package also includes a small Perl module to make using the calendar easier from TWiki plugins. This module includes the functions:

### <a name="TWiki::Contrib::_JSCalendarContr"></a> TWiki::Contrib::JSCalendarContrib::renderDateForEdit($name, $value, $format [, \\%cssClass]) -&gt; $html

This is the simplest way to use calendars from a plugin.

- `$name` is the name of the CGI parameter for the calendar (it should be unique),
- `$value` is the current value of the parameter (may be undef)
- `$format` is the format to use (optional; the default is set in `configure`). The HTML returned will display a date field and a drop-down calendar.
- `\%options` is an optional hash containing base options for the textfield.

Example:

    use TWiki::Contrib::JSCalendarContrib;
    ...
    my $fromDate = TWiki::Contrib::JSCalendarContrib::renderDateForEdit(
       'from', '1 April 1999');
    my $toDate = TWiki::Contrib::JSCalendarContrib::renderDateForEdit(
       'to', undef, '%Y');

### <a name="TWiki::Contrib::_JSCalendarContr"></a> TWiki::Contrib::JSCalendarContrib::addHEAD($setup)

This function will automatically add the headers for the calendar to the page being rendered. It's intended for use when you want more control over the formatting of your calendars than `renderDateForEdit` affords. `$setup` is the name of the calendar setup module; it can either be omitted, in which case the method described in the Mishoo documentation can be used to create calendars, or it can be `'twiki'`, in which case a Javascript helper function called 'showCalendar' is added that simplifies using calendars to set a value in a text field. For example, say we wanted to display the date with the calendar icon _before_ the text field, using the format `%Y %b %e`

    # Add styles and javascript for the calendar
    use TWiki::Contrib::JSCalendarContrib;
    ...

    sub commonTagsHandler {
      ....
      # Enable 'showCalendar'
      TWiki::Contrib::JSCalendarContrib::addHEAD( 'twiki' );

      my $cal = CGI::image_button(
          -name => 'img_datefield',
          -onclick =>
           "return showCalendar('id_datefield','%Y %b %e')",
          -src=> TWiki::Func::getPubUrlPath() . '/' .
                 TWiki::Func::getTwikiWebname() .
                 '/JSCalendarContrib/img.gif',
          -alt => 'Calendar',
          -align => 'middle' )
        . CGI::textfield(
          { name => 'date', id => "id_datefield" });
      ....
    }

The first parameter to `showCalendar` is the id of the textfield, and the second parameter is the . See the Mishoo documentation for details of the '$e %B %Y' parameter.

`addHEAD` can be called from `commonTagsHandler` for adding the header to all pages, or from `beforeEditHandler` just for edit pages etc.

### <a name="Using the Calendar in user forms"></a> Using the Calendar in user forms

You can also use the calendar directly in your own hand-built forms, without having to write any code. Just add this inline in the topic text:

    %INCLUDE{"%SYSTEMWEB%/JSCalendarContribInline"}%

Then, to display a calendar icon next to a text input field:

    <input type="text" id="cal_val_here" />
    <input type="image" src="%PUBURL%/%SYSTEMWEB%/JSCalendarContrib/img.gif" onclick="javascript: return showCalendar('cal_val_here','%e %B %Y')" />

If the contrib is installed, you will see such a field here:

<input id="cal_val_here" type="text" />
 <input onclick="javascript: return showCalendar('cal_val_here','%e %B %Y')" src="http://www.dementia.org/twiki//view/%SYSTEMWEB%/JSCalendarContrib/img.gif" type="image" />

### <a name="Installation Instructions"></a> Installation Instructions

You do not need to install anything in the browser to use this extension. The following instructions are for the administrator who installs the extension on the server where TWiki is running.

Like many other TWiki extensions, this module is shipped with a fully automatic installer script written using the BuildContrib.

- If you have TWiki 4.2 or later, you can install from the `configure` interface (Go to Plugins-&gt;Find More Extensions)
  - See the [installation supplement](http://twiki.org/cgi-bin/view/Plugins/BuildContribInstallationSupplement) on TWiki.org for more information.
- If you have any problems, then you can still install manually from the command-line:
  1. Download one of the `.zip` or `.tgz` archives
  2. Unpack the archive in the root directory of your TWiki installation.
  3. Run the installer script ( `perl <module>_installer` )
  4. Run `configure` and enable the module, if it is a plugin.
  5. Repeat for any missing dependencies.
- If you are **still** having problems, then instead of running the installer script:
  1. Make sure that the file permissions allow the webserver user to access all files.
  2. Check in any installed files that have existing `,v` files in your existing install (take care **not** to lock the files when you check in)
  3. Manually edit LocalSite.cfg to set any configuration variables.

<div class="twikiAlert">%X% WARNING: SYSTEMWEB is not defined in this TWiki. Please add these definitions to your [[Main/TWikiPreferences]], if they are not already there:<br /><pre>   * Set SYSTEMWEB = %TWIKIWEB%<br />   * Set USERSWEB = %MAINWEB%</pre></div>

- An administrator can customize the appearance of the calendar by setting the following in `LocalSite.cfg`<table border="1" cellpadding="0" cellspacing="0">
  <tr>
    <th bgcolor="#99CCCC"><strong> Setting </strong></th>
    <th bgcolor="#99CCCC"><strong> Default </strong></th>
  </tr>
  <tr>
    <td><code>$TWiki::cfg{JSCalendarContrib}{style}</code></td>
    <td><code>'blue'</code></td>
  </tr>
  <tr>
    <td><code>$TWiki::cfg{JSCalendarContrib}{lang}</code></td>
    <td><code>'en'</code></td>
  </tr>
  <tr>
    <td><code>$TWiki::cfg{JSCalendarContrib}{format}</code></td>
    <td><code>'%e %b %Y'</code></td>
  </tr>
</table>

### <a name="Contrib Info"></a> Contrib Info

Another great TWiki extension from the [![](http://www.dementia.org/twiki//view/wikiringlogo20x20.png) **WikiRing** ](http://wikiring.com) - working together to improve your wiki experience!

<table border="1" cellpadding="0" cellspacing="0">
  <tr>
    <td align="right"> Author: </td>
    <td> TWiki:Main/CrawfordCurrie <a href="http://c-dot.co.uk" target="_top">http://c-dot.co.uk</a></td>
  </tr>
  <tr>
    <td align="right"> Version: </td>
    <td> 16236 (22 Jan 2008) of the Mishoo calendar </td>
  </tr>
  <tr>
    <td align="right"> Copyright ©: </td>
    <td> See <a href="http://www.dementia.org/twiki//view/doc/html/reference.html" target="_top">the Mishoo documentation</a></td>
  </tr>
  <tr>
    <td align="right"> License: </td>
    <td> GPL (<a href="http://www.gnu.org/copyleft/gpl.html" target="_top">GNU General Public License</a>) </td>
  </tr>
  <tr>
    <td align="right"> Dependencies: </td>
    <td> None </td>
  </tr>
  <tr>
    <td> Change History: </td>
    <td>   </td>
  </tr>
  <tr>
    <td align="right"> 6 Sep 2007 </td>
    <td> Bugs:Item4030 Added doc for using the calendar in user forms </td>
  </tr>
  <tr>
    <td align="right"> 13603 </td>
    <td> Bugs:Item2982 cleaned up the interface to the contrib, re-added a date rendering function with a more generic interface </td>
  </tr>
  <tr>
    <td align="right"> 11594 </td>
    <td> Allow format to be configured. </td>
  </tr>
  <tr>
    <td align="right"> 11415 </td>
    <td> Add a <code>renderFormFieldForEditHandler</code> so other plugins can forward to this handler to add the date field to the [[Main/TWikiForms]]. (TWiki:Main.ThomasWeigert) </td>
  </tr>
  <tr>
    <td align="right"> 10247 </td>
    <td> Bugs:Item2054 put the calendar at z-index 2000, way above pattern skin divs. </td>
  </tr>
  <tr>
    <td align="right"> 6634 </td>
    <td> Bugs:Item453 removed [[Main/EditTablePlugins]] private copy of the Mishoo JS calendar, and made sure it works with [[Main/JSCalendarContrib]]. Improved the documentation of the JSCalendar while I was there. </td>
  </tr>
  <tr>
    <td align="right"> 6626 </td>
    <td> Bugs:Item468 updated docs for Dakar release </td>
  </tr>
  <tr>
    <td align="right"> 5048 </td>
    <td> Cairo readiness </td>
  </tr>
  <tr>
    <td align="right"> 5039 </td>
    <td> Split from [[Main/SharedCode]]</td>
  </tr>
  <tr>
    <td align="right"> 27 Dec 2005 </td>
    <td> updated to calendar version 1.0; set style for Safari to win2k-1 </td>
  </tr>
  <tr>
    <td align="right"> 14 Aug 2004 </td>
    <td> Separated out from [[Main/SharedCode]] module </td>
  </tr>
  <tr>
    <td align="right"> Home: </td>
    <td><a href="http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%" target="_top">http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%</a></td>
  </tr>
  <tr>
    <td align="right"> Feedback: </td>
    <td><a href="http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Dev" target="_top">http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Dev</a></td>
  </tr>
  <tr>
    <td align="right"> Appraisal: </td>
    <td><a href="http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Appraisal" target="_top">http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Appraisal</a></td>
  </tr>
</table>

**_Related Topics:_** %SYSTEMWEB%.TWikiPreferences
